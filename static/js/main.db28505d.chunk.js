(this["webpackJsonpjoplin-charts"]=this["webpackJsonpjoplin-charts"]||[]).push([[0],{221:function(C,p,e){"use strict";var s=e(438),h=e(439),F=e(117),P=e(283),B=e(441),g=e(1),U=e.n(g),K=e(277),k=e.n(K),x=e(278),T=e(30),m=e(442),I=e(443),J=e(23),E=e(25),O=e(74),j=(S,b,D)=>new Promise((y,A)=>{var N=M=>{try{L(D.next(M))}catch(f){A(f)}},W=M=>{try{L(D.throw(M))}catch(f){A(f)}},L=M=>M.done?y(M.value):Promise.resolve(M.value).then(N,W);L((D=D.apply(S,b)).next())});const v={lng:navigator.language,fallbackLng:"en",resources:{en:{translation:{successMsg:"The verification is successful, and you are about to enter the homepage",errorMsg:"Verification failed, please check whether the authorization token and port number are correct",settingFormHeader:"Settings page",tokenLabel:"Token",tokenErrorRequiredMsg:"Token is required",portLabel:"Port",portErrorRequiredMsg:"Port is required",submitText:"Submit"}},"zh-CN":{translation:{successMsg:"\u9A8C\u8BC1\u6210\u529F\uFF0C\u5373\u5C06\u8FDB\u5165\u4E3B\u9875",errorMsg:"\u9A8C\u8BC1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6388\u6743 token \u4EE4\u724C\u4E0E\u7AEF\u53E3\u53F7\u662F\u5426\u6B63\u786E",settingFormHeader:"\u8BBE\u7F6E\u9875",tokenLabel:"\u6388\u6743 Token \u4EE4\u724C",tokenErrorRequiredMsg:"token \u662F\u5FC5\u586B\u9879",portLabel:"\u7AEF\u53E3",portErrorRequiredMsg:"\u7AEF\u53E3\u662F\u5FC5\u586B\u9879",submitText:"\u63D0\u4EA4"}}}},R=()=>{const S=Object(m.a)(()=>E.a.init(v),[]),{register:b,handleSubmit:D,errors:y}=Object(x.a)({defaultValues:{port:41184}}),[,A]=Object(I.a)("settingForm"),N=Object(J.f)(),{success:W,error:L}=Object(O.a)();function M(f){return j(this,null,function*(){console.log("handleSubmit: ",f);try{T.b.token=f.token,T.b.port=f.port,yield T.e.list({fields:[],limit:1}),A(T.b),W(E.a.t("successMsg")),N.push("/")}catch(H){L(E.a.t("errorMsg"))}})}return g.createElement(g.Fragment,null,S.value&&g.createElement(s.a,{container:!0,justify:"center",alignItems:"center",className:k.a.container},g.createElement(h.a,{maxWidth:"xs"},g.createElement(F.a,{component:"h1",variant:"h5"},E.a.t("settingFormHeader")),g.createElement("form",{onSubmit:D(M)},g.createElement(P.a,{fullWidth:!0,name:"token",label:E.a.t("tokenLabel"),autoFocus:!0,error:!!y.token,inputRef:b({required:E.a.t("tokenErrorRequiredMsg")}),helperText:y.token?y.token.message:" "}),g.createElement(P.a,{fullWidth:!0,name:"port",label:E.a.t("portLabel"),error:!!y.port,inputRef:b({required:E.a.t("portErrorRequiredMsg")}),helperText:y.port?y.port.message:" "}),g.createElement(B.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary"},E.a.t("submitText"))))))};p.a=R},222:function(C,p){},276:function(C,p,e){"use strict";var s=e(221);e.d(p,"default",function(){return s.a});var h=e(222),F=e.n(h)},277:function(C,p,e){C.exports={container:"JoplinSetting_container__3qmxA"}},280:function(C,p,e){C.exports={root:"Home_root__y74vd"}},437:function(C,p,e){"use strict";e.r(p);var s=e(1),h=e.n(s),F=e(20),P=e.n(F);const B=Boolean(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function g(r){if("serviceWorker"in navigator){const a=new URL(".",window.location.href);if(a.origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="./service-worker.js";B?(K(t,r),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):U(t,r)})}}function U(r,a){navigator.serviceWorker.register(r).then(t=>{t.onupdatefound=()=>{const o=t.installing;if(o==null)return;o.onstatechange=()=>{o.state==="installed"&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),a&&a.onUpdate&&a.onUpdate(t)):(console.log("Content is cached for offline use."),a&&a.onSuccess&&a.onSuccess(t)))}}}).catch(t=>{console.error("Error during service worker registration:",t)})}function K(r,a){fetch(r,{headers:{"Service-Worker":"script"}}).then(t=>{const o=t.headers.get("content-type");t.status===404||o!=null&&o.indexOf("javascript")===-1?navigator.serviceWorker.ready.then(l=>{l.unregister().then(()=>{window.location.reload()})}):U(r,a)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}function k(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(r=>{r.unregister()}).catch(r=>{console.error(r.message)})}var x=e(23),T=e(281),m=e(30),I=(r,a,t)=>new Promise((o,l)=>{var u=n=>{try{i(t.next(n))}catch(c){l(c)}},d=n=>{try{i(t.throw(n))}catch(c){l(c)}},i=n=>n.done?o(n.value):Promise.resolve(n.value).then(u,d);i((t=t.apply(r,a)).next())});class J{countList(){return I(this,null,function*(){const a=yield m.a.pageToAllList(m.f.list);return yield Promise.all(a.map(t=>I(this,null,function*(){return{id:t.id,tag:t.title,count:(yield m.a.pageToAllList(m.f.notesByTagId,{id:t.id})).length}})))})}}const E=new J;var O=e(505),j=e(128),v=e(25),R=e(74),S=(r,a,t)=>new Promise((o,l)=>{var u=n=>{try{i(t.next(n))}catch(c){l(c)}},d=n=>{try{i(t.throw(n))}catch(c){l(c)}},i=n=>n.done?o(n.value):Promise.resolve(n.value).then(u,d);i((t=t.apply(r,a)).next())});const b={lng:navigator.language,fallbackLng:"en",resources:{en:{translation:{successMsg:"Successfully loaded the joplin tag list",errorMsg:"Failed to load joplin tag list"}},"zh-CN":{translation:{successMsg:"Joplin \u6807\u7B7E\u5217\u8868\u52A0\u8F7D\u6210\u529F",errorMsg:"Joplin \u6807\u7B7E\u5217\u8868\u52A0\u8F7D\u5931\u8D25"}}}},D=()=>{const{success:r,error:a}=Object(R.a)();return Object(O.a)(()=>S(void 0,null,function*(){yield v.a.init(b);try{const t=yield E.countList(),o=new j.WordCloud("container",{data:t,wordField:"tag",weightField:"count",colorField:"tag",random:()=>.5});o.render(),r(v.a.t("successMsg"))}catch(t){console.error(t),a(v.a.t("errorMsg"))}})),s.createElement("div",{id:"container",style:{width:"100%",height:"100vh"}})};var y=D,A=e(272),N=e.n(A);class W{static convert(a){const t=new N.a,o=a.reduce((u,d)=>(u.set(d.id,d),u),new Map);function l(u){const d=t.parseInline(u.body,"");return d[0].children.filter(i=>{var n;return i.type==="link_open"&&((n=i.attrGet("href"))==null?void 0:n.startsWith(":/"))}).map(i=>{var n;return(n=i.attrGet("href"))==null?void 0:n.substr(2)}).filter(i=>o.has(i)).map(i=>({id:i,title:o.get(i).title}))}return a.map(u=>({id:u.id,title:u.title,links:l(u)}))}}var L=e(273),M=e(220),f=Object.assign,H=(r,a,t)=>new Promise((o,l)=>{var u=n=>{try{i(t.next(n))}catch(c){l(c)}},d=n=>{try{i(t.throw(n))}catch(c){l(c)}},i=n=>n.done?o(n.value):Promise.resolve(n.value).then(u,d);i((t=t.apply(r,a)).next())});const _={lng:navigator.language,fallbackLng:"en",resources:{en:{translation:{successMsg:"Succeeded in loading note diagram",errorMsg:"Failed to load note diagram"}},"zh-CN":{translation:{successMsg:"\u52A0\u8F7D\u7B14\u8BB0\u5173\u7CFB\u56FE\u6210\u529F",errorMsg:"\u52A0\u8F7D\u7B14\u8BB0\u5173\u7CFB\u56FE\u5931\u8D25"}}}};function tt(){return H(this,null,function*(){const r=yield m.a.pageToAllList(m.e.list,{fields:["id","title","body"]}),a=W.convert(r),t={nodes:a.map(o=>{const l={id:o.id,label:o.title.startsWith("#")?o.title.replace("# ",""):o.title};return f(f({data:l},l),{shape:"CircleNode",style:{nodeSize:24*Math.min(1+o.links.length,5)}})}),edges:a.flatMap(o=>o.links.map(l=>{const u={source:o.id,target:l.id};return f({data:u},u)}))};return t})}const et=()=>{const[r,a]=Object(s.useState)({edges:[],nodes:[]}),{success:t,error:o}=Object(R.a)(),l=Object(x.f)();return Object(O.a)(()=>H(void 0,null,function*(){yield v.a.init(_);try{const u=yield tt();a(u),t(v.a.t("successMsg"))}catch(u){o(v.a.t("errorMsg")),l.push("/setting")}})),s.createElement("div",{style:{height:"100vh"}},s.createElement(L.a,{data:r,layout:{name:"force",options:{preset:{name:"concentric"},preventOverlap:!0,centripetalOptions:{single:100,center:()=>({x:100,y:100})}}}}))};var nt=et,at=e(276),ot=e(439),V=e(490),rt=e(491),$=e(492),st=e(489),lt=e(493),it=e(280),ut=e.n(it),G=e(442),w=e(114);const ct={lng:navigator.language,fallbackLng:"en",resources:{en:{translation:{settingRouteName:"Set up Joplin Token/Port",relationRouteName:"Relation chart",tagRouteName:"Tag Cloud",sunburstRouteName:"Note directory size analysis chart",timelineName:"timeline",chartList:"Chart list"}},"zh-CN":{translation:{settingRouteName:"\u8BBE\u7F6E Joplin Token/Port",relationRouteName:"\u5173\u7CFB\u56FE",tagRouteName:"\u6807\u7B7E\u4E91",sunburstRouteName:"\u7B14\u8BB0\u76EE\u5F55\u5927\u5C0F\u5206\u6790\u56FE",timelineName:"\u65F6\u95F4\u7EBF",chartList:"\u56FE\u8868\u5217\u8868"}}}},dt=[{label:"settingRouteName",to:"/setting"},{label:"tagRouteName",to:"/tag"},{label:"relationRouteName",to:"/relation"},{label:"sunburstRouteName",to:"/sunburst"},{label:"timelineName",to:"/timeline"}],mt=()=>{const r=Object(G.a)(()=>v.a.init(ct),[]);return s.createElement(s.Fragment,null,r.value&&s.createElement(ot.a,{maxWidth:"sm",className:ut.a.root},s.createElement(V.a,null,s.createElement(rt.a,{title:v.a.t("chartList")}),s.createElement($.a,null,s.createElement(st.a,{component:"nav"},dt.map(a=>s.createElement(lt.a,null,s.createElement(w.b,{to:a.to},v.a.t(a.label)))))))))};var vt=mt,Q=e(103),ht=(r,a,t)=>new Promise((o,l)=>{var u=n=>{try{i(t.next(n))}catch(c){l(c)}},d=n=>{try{i(t.throw(n))}catch(c){l(c)}},i=n=>n.done?o(n.value):Promise.resolve(n.value).then(u,d);i((t=t.apply(r,a)).next())});const gt=()=>{const r=Object(Q.b)();return Object(O.a)(()=>ht(void 0,null,function*(){const a=yield m.c.listAll(),t=a[0],o=yield m.e.create({title:"test title",body:"test body",parent_id:t.id});r.enqueueSnackbar(`Create note successfully: [${o.title}], The list of notes is: [${t.title}]`,{variant:"success",autoHideDuration:3e3})})),s.createElement("div",null,"CreateNoteDemo")};var Et=gt,ft=(r,a,t)=>new Promise((o,l)=>{var u=n=>{try{i(t.next(n))}catch(c){l(c)}},d=n=>{try{i(t.throw(n))}catch(c){l(c)}},i=n=>n.done?o(n.value):Promise.resolve(n.value).then(u,d);i((t=t.apply(r,a)).next())});function pt(){return ft(this,null,function*(){const r=yield m.c.listAll();function a(t){var o;return{label:t.title,sum:t.note_count,children:(o=t.children)==null?void 0:o.map(a)}}return{label:"root",children:r.map(a)}})}var yt=(r,a,t)=>new Promise((o,l)=>{var u=n=>{try{i(t.next(n))}catch(c){l(c)}},d=n=>{try{i(t.throw(n))}catch(c){l(c)}},i=n=>n.done?o(n.value):Promise.resolve(n.value).then(u,d);i((t=t.apply(r,a)).next())});const Mt={lng:navigator.language,fallbackLng:"en",resources:{en:{translation:{successMsg:"The notebook list is loaded successfully",errorMsg:"Failed to load notebook list"}},"zh-CN":{translation:{successMsg:"\u7B14\u8BB0\u672C\u5217\u8868\u52A0\u8F7D\u6210\u529F",errorMsg:"\u7B14\u8BB0\u672C\u5217\u8868\u52A0\u8F7D\u5931\u8D25"}}}},Ct=()=>{const{success:r,error:a}=Object(R.a)();return Object(O.a)(()=>yt(void 0,null,function*(){yield v.a.init(Mt);try{const t=yield pt();r(v.a.t("successMsg"));const o=new j.Sunburst("container",{data:t,type:"treemap",reflect:"y",seriesField:"sum",colorField:"label",innerRadius:.3,interactions:[{type:"element-active"}]});o.render()}catch(t){a(v.a.t("errorMsg"))}})),s.createElement("div",{id:"container",style:{height:"100vh"}})};var Ot=Ct,Dt=e(495),Ft=e(496),Pt=e(498),Bt=e(500),Lt=e(501),Tt=e(499),bt=e(494),X=e(117),At=e(502),Rt=e(441),St=e(497),z=(r,a,t)=>new Promise((o,l)=>{var u=n=>{try{i(t.next(n))}catch(c){l(c)}},d=n=>{try{i(t.throw(n))}catch(c){l(c)}},i=n=>n.done?o(n.value):Promise.resolve(n.value).then(u,d);i((t=t.apply(r,a)).next())});const Nt={lng:navigator.language,fallbackLng:"en",resources:{en:{translation:{openNoteAction:"Open in editor"}},"zh-CN":{translation:{openNoteAction:"\u5728\u7F16\u8F91\u5668\u4E2D\u6253\u5F00"}}}},Wt=()=>{const r=Object(G.a)(()=>z(void 0,null,function*(){return yield m.a.pageToAllList(m.e.list,{fields:["id","title","body","user_updated_time"],order_by:"user_updated_time",order_dir:"DESC"})}),[]);Object(O.a)(()=>z(void 0,null,function*(){yield v.a.init(Nt)}));function a(t){return z(this,null,function*(){yield m.d.openAndWatch(t)})}return s.createElement(s.Fragment,null,r.loading?s.createElement(bt.a,null):s.createElement(Dt.a,{align:"alternate"},r.value.map((t,o)=>s.createElement(Ft.a,null,s.createElement(St.a,null,s.createElement(X.a,{color:"textSecondary"},new Date(t.user_updated_time).toLocaleString())),s.createElement(Pt.a,null,s.createElement(Tt.a,{color:o%2===0?"primary":"secondary"}),s.createElement(Bt.a,null)),s.createElement(Lt.a,null,s.createElement(V.a,null,s.createElement($.a,null,s.createElement(X.a,{variant:"h5"},t.title.startsWith("#")?t.title.replace("# ",""):t.title)),s.createElement(At.a,null,s.createElement(Rt.a,{onClick:()=>a(t.id)},v.a.t("openNoteAction")))))))))};var xt=Wt;const It=[{path:"/setting",component:at.default},{path:"/tag",component:y},{path:"/sunburst",component:Ot},{path:"/relation",component:nt},{path:"/demo/create-note",component:Et},{path:"/timeline",component:xt},{path:"/",component:vt}];var jt=e(443);class Ut{constructor(a){this.storage=a,this.clear=()=>{this.storage.clear()},this.getItem=t=>this.storage.getItem(t),this.key=t=>this.storage.key(t),this.removeItem=t=>{this.storage.removeItem(t)},this.setItem=(t,o)=>{this.storage.setItem(t,o)}}get length(){return this.storage.length}}function Kt(r){const a=new Set(["storage","length","clear","getItem","setItem","removeItem","key"]);return new Proxy(new Ut(r),{get(t,o,l){if(a.has(o))return Reflect.get(t,o,l);try{return JSON.parse(t.getItem(o.toString()))}catch(u){return null}},set(t,o,l,u){return a.has(o)?Reflect.set(t,o,u):(t.setItem(o.toString(),l!=null?JSON.stringify(l):l),!0)}})}var Y,Z;const q=Kt(localStorage);m.b.token=(Y=q.settingForm)==null?void 0:Y.token,m.b.port=(Z=q.settingForm)==null?void 0:Z.port;const kt=()=>{const[r]=Object(jt.a)("settingForm"),a=Object(x.f)();return Object(O.a)(()=>{if(!(r==null?void 0:r.token)||!(r==null?void 0:r.port)){a.push("/setting");return}}),Object(T.a)(It)};var Jt=kt,zt=e(436),Ht=e(503);P.a.render(h.a.createElement(h.a.StrictMode,null,h.a.createElement(Ht.a,{locale:window.navigator.language},h.a.createElement(Q.a,{maxSnack:3},h.a.createElement(w.a,null,h.a.createElement(Jt,null))))),document.getElementById("root")),k()},74:function(C,p,e){"use strict";e.d(p,"a",function(){return h});var s=e(103);function h(){const F=Object(s.b)(),P=3e3;return{success(B){F.enqueueSnackbar(B,{variant:"success",autoHideDuration:P})},error(B){F.enqueueSnackbar(B,{variant:"error",autoHideDuration:P})}}}}},[[437,1,2]]]);

//# sourceMappingURL=main.db28505d.chunk.js.map